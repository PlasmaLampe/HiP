<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for javascripts/controller/LanguageController.js</title>
    <meta charset="utf-8">

    <link rel="stylesheet" href="../../prettify.css">

    <link rel="stylesheet" href="../../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header medium">
    <h1>Code coverage report for <span class="entity">javascripts/controller/LanguageController.js</span></h1>
    <h2>
        
        Statements: <span class="metric">68.18% <small>(30 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">50% <small>(8 / 16)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">50% <small>(5 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">68.18% <small>(30 / 44)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../index.html">All files</a> &#187; <a href="index.html">javascripts/controller/</a> &#187; LanguageController.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-yes">8</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Created by JÃ¶rg Amelunxen on 29.10.2014.
 *
 * @class angular_module.controllersModule.LangCtrl
 *
 * This controller implements the complete translation functionality. It is able to retrieve terms, load
 * dictionaries, etc.
 */
controllersModule.controller('LangCtrl', ['$http', function($http) {
    this.debug = false;
    var errorString = "not fetched yet: ";
&nbsp;
    var that = this;
&nbsp;
    this.language = {
        init:false
    };
&nbsp;
    this.defaultLanguage = "de";
&nbsp;
    this.errorObject = {
        content:"Connection Error",
        sender:"System"
    };
&nbsp;
    /**
     * This function returns the corresponding string the in active language
     *
     * @param key
     * @returns         the needed string
     */
    this.getTerm = function(key){
        var found = (that.language[key] != undefined);
&nbsp;
        if(found)
            return that.language[key];
        else
            return errorString + key;
    };
&nbsp;
    /**
     * Returns the name of the specified key of a type object
     *
     * @param key       The key that should be used for lookup
     * @param typeName  The name type that includes the key
     * @returns {the}   The name of the key
     */
    this.getTypeKeyName = <span class="fstat-no" title="function not covered" >function(key, typeName){</span>
<span class="cstat-no" title="statement not covered" >        var lookupString = 'type_'+key+'_'+typeName;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        return that.getTerm(lookupString);</span>
    };
&nbsp;
    /**
     * This function creates a correct notification from notification data
     *
     * @param data      of the structure: [system_call, optional data like username, etc.]
     * @returns {*}     The correct notification
     */
    this.getNotification = function (data) {
        var res = data.split(",");
&nbsp;
        <span class="missing-if-branch" title="if path not taken" >I</span>if(res[0] == "system_notification_groupTopicUpdated1"){
<span class="cstat-no" title="statement not covered" >            var notiMessage1 = that.getTerm(res[0]);</span>
<span class="cstat-no" title="statement not covered" >            var notiMessage2 = that.getTerm(res[2]);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >            return notiMessage1 + " " + res[1] + " " + notiMessage2 + " " + res[3];</span>
        }
        else{
            var notiMessage = that.getTerm(res[0]);
&nbsp;
            return notiMessage + " " + res[1];
        }
    };
&nbsp;
    /**
     * Sends a new term to the server. The term is already stored internally in that.currentTerm.
     */
    this.createTerm = <span class="fstat-no" title="function not covered" >function(){</span>
<span class="cstat-no" title="statement not covered" >        $http.post('/admin/languages', that.currentTerm).</span>
            success(<span class="fstat-no" title="function not covered" >function(data, status, headers, config) {</span>
            }).
            error(<span class="fstat-no" title="function not covered" >function(data, status, headers, config) {</span>
            });
    };
&nbsp;
    /**
     * This function loads the complete dictionary from the server
     *
     * @param lang  the needed language, e.g., 'eng' or 'de'
     */
    this.getLanguage = function (lang){
        <span class="missing-if-branch" title="if path not taken" >I</span>if(this.debug)
<span class="cstat-no" title="statement not covered" >            console.log("info LangCtrl: Fetching language")</span>
&nbsp;
        $http.get('/admin/languages/'+lang).
            success(function(data, status, headers, config) {
                <span class="missing-if-branch" title="if path not taken" >I</span>if(that.debug){
<span class="cstat-no" title="statement not covered" >                    console.log("info LangCtrl: getting response data")</span>
                }
&nbsp;
                /* transform data into a single JSON doc */
                for(entry in data){
                    that.language[data[entry].key] = data[entry].value
                }
&nbsp;
                // prevent init again
                that.language.init  =   true;
&nbsp;
                <span class="missing-if-branch" title="if path not taken" >I</span>if(that.debug){
<span class="cstat-no" title="statement not covered" >                    console.log("info LangCtrl: Language is now " + lang)</span>
<span class="cstat-no" title="statement not covered" >                    console.log(that.language)</span>
                }
            }).
            error(<span class="fstat-no" title="function not covered" >function(data, status, headers, config) {</span>
<span class="cstat-no" title="statement not covered" >                if(that.debug){</span>
<span class="cstat-no" title="statement not covered" >                    console.log("error LangCtrl: Could not fetch the data &gt;&gt; Server response " + status)</span>
                }
&nbsp;
<span class="cstat-no" title="statement not covered" >                that.language = that.errorObject;</span>
            });
    };
&nbsp;
    <span class="missing-if-branch" title="else path not taken" >E</span>if(this.language.init == false){
        // init language
        <span class="missing-if-branch" title="if path not taken" >I</span>if(this.debug)
<span class="cstat-no" title="statement not covered" >            console.log("info: Language gets initialised:" + this.defaultLanguage)</span>
&nbsp;
        this.getLanguage(this.defaultLanguage);
    }
}]);</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Mar 02 2015 10:29:25 GMT+0100 (CET)</div>
</div>

<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>

<script src="../../sorter.js"></script>
</body>
</html>
